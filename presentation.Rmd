---
title: "Presentation"
author: "Group 3"
date: "10/16/2019"
output: slidy_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Group 3

Assignments:

- What are the design parameters? Adina
- What are performance metrics?
- Which dose will you start the trial at?

## Model

One approach: 

  - Weighted combination of toxicity outcomes proportionate to seriousness of event = Total toxicity burden (TTB) (Bekele and Thall, 2004)
    - Some problems: Total toxicity burden is not that interpretable (compared to setting separate limits for each grade of outcome)
    - Not for this problem, but for others, the modelled distribution can get high-dimensional if there are many types of toxicity.
    
## Model

Alternate approach (Lee et al., 2011): define the MTD with respect to multiple toxicity contraints set on the separate grades:

$$MTD = \theta = argmax\{Pr(T \ge t_{l}|x) \le p_l, \ l = 1, ... L\}$$
To identify the model, define a  latent normally-distributed variable Z with:
  
  $$EZ = \alpha + \beta x, \ Var(Z) = 1$$ 
  
Such that:

$$t_l \le T \le t_{l+1} \ \ iff \ \ \gamma_l \le Z \le \gamma_{l+1}$$

## Model, continued
 
In this way, it's not necessary to directly model the distribution T within each interval $[t_l, t_{l+1}]$, while still allowing ourselves to identify the distribution:
    
$$Pr(t_l \le T \le t_{l+1}|x) = Pr(\gamma_l \le Z \le \gamma_{l+1} | x)$$ 

$$Pr(t_l \le T \le t_{l+1}|x) = Pr(Z \le \gamma_{l+1} | x) - Pr(Z \le \gamma_{l} | x)$$ 
$$= Pr({Z - EZ}\le \gamma_{l+1} - (\alpha + \beta x)  | x) - Pr({Z - EZ} \le \gamma_{l} - (\alpha + \beta x) | x)$$ 
$$= \Phi(\gamma_{l+1} - (\alpha + \beta x)) - \Phi(\gamma_{l} - (\alpha + \beta x))$$ 
$$Pr(T \le t_{l+1}|x) - Pr(T \le t_{l} | x) = \Phi(\gamma_{l+1} - (\alpha + \beta x)) - \Phi(\gamma_{l} - (\alpha + \beta x))$$ 

## Model result

  - Since $t_0 \equiv 0$:
  
  $$-1*Pr(T \le t_{l} | x) =  -1*\Phi(\gamma_{l} - (\alpha + \beta x))$$
  
$$Pr(T \ge t_{l} | x) =  \Phi(\alpha + \beta x - \gamma_{l})$$
  
Note our objective:

$$MTD = \theta = argmax\{Pr(T \ge t_{l}|x) \le p_l, \ l = 1, ... L\}$$
$$\theta = argmax\{\Phi(\alpha + \beta x - \gamma_{l})\le p_l\, \ l = 1, ... L\}$$

## Design Parameters

For modelling:

  - Take $\alpha = 3$ (convention, Cheung 2002).
  
  - Objective can be written as  $\theta = min\{\theta_1, ..., \theta_L\} = \theta_{\lambda}$, where each toxicity constraint is met at the respective dose levels:
    -  Note that the inverse normal CDF is the probit

  
$$\theta_l = \frac{{\gamma_l + \Phi^{−1}(p_l) − 3}}{\beta}$$
  
- So what we need to estimate is an explicit function of our design parameters: $\gamma_1, \gamma_2, p_1, p_2, \beta$

- Specify prior distributions for  $\gamma_1, \gamma_2, \beta$ $\sim exp(1)$

- Specify target $p_1, p_2$

## Performance metrics

- Estimated probability of correct selection 

- Average probability of dose selection for all doses

- Patient allocation: proportion of patients treated at each level

- Mean, median and interquartile range (IQR) for the estimated probability of DLT, grade level 2

- Mean, median and interquartile range (IQR) for the estimated probability of DLT, grade level 1

- E(TTB)

## Choosing Starting Dose

- "Since $\theta = min\{\theta_1, ..., \theta_L\} \le \theta_1$, it is reasonable to believe that a prior guess of MTD should be somewhere below $d_v$. In light of this, we call a starting dose $x_1$ permissible if $x_1 \le d_v$." (Lee et al., 2011)

- In this problem, L = 2 and the prior MTDs $d_v$ is for L = 2 for each product.

- Further, the two $d_v$ are for the component, not combination, products.

- This suggests we should start the dose finding at a lower dose

- Choose the lowest dose

```{r pressure}
plot(pressure)
```

